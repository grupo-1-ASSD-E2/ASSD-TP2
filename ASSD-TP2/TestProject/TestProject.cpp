#include "pch.h"
#include "CppUnitTest.h"
#include "fft.h"
#include "NumCpp.h"

#include <cmath>

#define FFT_TEST_RESULT_1 {7.28583860e-17, 1.27746254e+02, 6.71072262e-01, 3.76906840e-01, 2.67946795e-01, 2.09339590e-01, 1.72286425e-01, 1.46602042e-01, 1.27696600e-01, 1.13176527e-01, 1.01664136e-01, 9.23076203e-02,8.45508182e-02, 7.80146361e-02, 7.24315042e-02, 6.76070309e-02,6.33965074e-02, 5.96899428e-02, 5.64022142e-02, 5.34663981e-02,5.08291429e-02, 4.84473872e-02, 4.62859893e-02, 4.43159827e-02, 4.25132755e-02, 4.08576645e-02, 3.93320800e-02, 3.79220008e-02, 3.66149947e-02, 3.54003559e-02, 3.42688148e-02, 3.32123052e-02, 3.22237747e-02, 3.12970304e-02, 3.04266119e-02, 2.96076858e-02, 2.88359582e-02, 2.81076020e-02, 2.74191943e-02, 2.67676653e-02, 2.61502534e-02, 2.55644675e-02, 2.50080550e-02, 2.44789738e-02, 2.39753683e-02, 2.34955485e-02, 2.30379721e-02, 2.26012290e-02, 2.21840268e-02, 2.17851796e-02, 2.14035966e-02, 2.10382732e-02, 2.06882827e-02, 2.03527686e-02, 2.00309384e-02, 1.97220578e-02, 1.94254452e-02, 1.91404674e-02, 1.88665353e-02, 1.86031000e-02, 1.83496498e-02, 1.81057069e-02, 1.78708246e-02, 1.76445851e-02, 1.74265972e-02, 1.72164940e-02, 1.70139312e-02, 1.68185857e-02, 1.66301537e-02, 1.64483492e-02, 1.62729033e-02, 1.61035624e-02, 1.59400875e-02, 1.57822532e-02, 1.56298465e-02, 1.54826664e-02, 1.53405227e-02, 1.52032356e-02, 1.50706350e-02, 1.49425598e-02, 1.48188574e-02, 1.46993832e-02, 1.45840002e-02, 1.44725783e-02, 1.43649942e-02, 1.42611307e-02, 1.41608769e-02, 1.40641271e-02, 1.39707811e-02, 1.38807436e-02, 1.37939243e-02, 1.37102372e-02, 1.36296005e-02, 1.35519367e-02, 1.34771719e-02, 1.34052361e-02, 1.33360628e-02, 1.32695885e-02, 1.32057534e-02, 1.31445003e-02, 1.30857752e-02, 1.30295267e-02, 1.29757062e-02, 1.29242675e-02, 1.28751670e-02, 1.28283635e-02, 1.27838180e-02, 1.27414935e-02, 1.27013556e-02, 1.26633715e-02, 1.26275105e-02, 1.25937438e-02, 1.25620447e-02, 1.25323880e-02, 1.25047503e-02, 1.24791100e-02, 1.24554471e-02, 1.24337433e-02, 1.24139819e-02, 1.23961476e-02, 1.23802269e-02, 1.23662074e-02, 1.23540786e-02, 1.23438313e-02, 1.23354577e-02, 1.23289514e-02, 1.23243075e-02, 1.23215226e-02, 1.23205945e-02, 1.23215226e-02, 1.23243075e-02, 1.23289514e-02, 1.23354577e-02, 1.23438313e-02, 1.23540786e-02, 1.23662074e-02, 1.23802269e-02, 1.23961476e-02, 1.24139819e-02, 1.24337433e-02, 1.24554471e-02, 1.24791100e-02, 1.25047503e-02, 1.25323880e-02, 1.25620447e-02, 1.25937438e-02, 1.26275105e-02, 1.26633715e-02, 1.27013556e-02, 1.27414935e-02, 1.27838180e-02, 1.28283635e-02, 1.28751670e-02, 1.29242675e-02, 1.29757062e-02, 1.30295267e-02, 1.30857752e-02, 1.31445003e-02, 1.32057534e-02, 1.32695885e-02, 1.33360628e-02, 1.34052361e-02, 1.34771719e-02, 1.35519367e-02, 1.36296005e-02, 1.37102372e-02, 1.37939243e-02, 1.38807436e-02, 1.39707811e-02, 1.40641271e-02, 1.41608769e-02, 1.42611307e-02, 1.43649942e-02, 1.44725783e-02, 1.45840002e-02, 1.46993832e-02, 1.48188574e-02, 1.49425598e-02, 1.50706350e-02, 1.52032356e-02, 1.53405227e-02, 1.54826664e-02, 1.56298465e-02, 1.57822532e-02, 1.59400875e-02, 1.61035624e-02, 1.62729033e-02, 1.64483492e-02, 1.66301537e-02, 1.68185857e-02, 1.70139312e-02, 1.72164940e-02, 1.74265972e-02, 1.76445851e-02, 1.78708246e-02, 1.81057069e-02, 1.83496498e-02, 1.86031000e-02, 1.88665353e-02, 1.91404674e-02, 1.94254452e-02, 1.97220578e-02, 2.00309384e-02, 2.03527686e-02, 2.06882827e-02, 2.10382732e-02, 2.14035966e-02, 2.17851796e-02, 2.21840268e-02, 2.26012290e-02, 2.30379721e-02, 2.34955485e-02, 2.39753683e-02, 2.44789738e-02, 2.50080550e-02, 2.55644675e-02, 2.61502534e-02, 2.67676653e-02, 2.74191943e-02, 2.81076020e-02, 2.88359582e-02, 2.96076858e-02, 3.04266119e-02, 3.12970304e-02, 3.22237747e-02, 3.32123052e-02, 3.42688148e-02, 3.54003559e-02, 3.66149947e-02, 3.79220008e-02, 3.93320800e-02, 4.08576645e-02, 4.25132755e-02, 4.43159827e-02, 4.62859893e-02, 4.84473872e-02, 5.08291429e-02, 5.34663981e-02, 5.64022142e-02, 5.96899428e-02, 6.33965074e-02, 6.76070309e-02, 7.24315042e-02, 7.80146361e-02, 8.45508182e-02, 9.23076203e-02, 1.01664136e-01, 1.13176527e-01, 1.27696600e-01, 1.46602042e-01, 1.72286425e-01, 2.09339590e-01, 2.67946795e-01, 3.76906840e-01, 6.71072262e-01, 1.27746254e+02}

using namespace Microsoft::VisualStudio::CppUnitTestFramework;

namespace TestProject
{
	TEST_CLASS(TestProject)
	{
	public:
		
		TEST_METHOD(FFTTest1)
		{
			vector<double> t = NumCpp::linspace(0.0, 256.0, 256);
			vector<double> signal = NumCpp::sin(t, 1.0 / 256.0);

			FFTCalculator fftCalc;
			vector<complex<double>> fft(256, 0.0);
			fftCalc.FFT(signal, fft, 256);
			vector<complex<double>> modFFT = NumCpp::abs(fft);

			vector<complex<double>> modFFTInOrder = NumCpp::rearangeInBitReverse(modFFT);
		}
	};
}
